<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="Hexo Theme Keep">
    <meta name="description" content="探究Android开发技术">
    <meta name="author" content="cfanr">
    
    <title>
        
        cfanr&#39;s Blog
    </title>
    
<link rel="stylesheet" href="/css/style.css">

    <link rel="shortcut icon" href="/images/logo.png">
    
<link rel="stylesheet" href="/css/font-awesome.min.css">

    <script id="hexo-configurations">
    let KEEP = window.KEEP || {};
    KEEP.hexo_config = {"hostname":"navyifanr.github.io","root":"/","language":"en"};
    KEEP.theme_config = {"toc":{"enable":false,"number":false,"expand_all":false,"init_open":false},"style":{"primary_color":"#0066CC","avatar":"/images/avatar.png","favicon":"/images/logo.png","article_img_align":"left","left_side_width":"260px","content_max_width":"920px","hover":{"shadow":false,"scale":false},"first_screen":{"enable":false,"background_img":"/images/bg.svg","description":"Keep writing and Keep loving."},"scroll":{"progress_bar":{"enable":false},"percent":{"enable":false}}},"local_search":{"enable":false,"preload":false},"code_copy":{"enable":false,"style":"default"},"pjax":{"enable":false},"lazyload":{"enable":false},"version":"3.4.5"};
    KEEP.language_ago = {"second":"%s seconds ago","minute":"%s minutes ago","hour":"%s hours ago","day":"%s days ago","week":"%s weeks ago","month":"%s months ago","year":"%s years ago"};
  </script>
<meta name="generator" content="Hexo 5.4.2"></head>


<body>
<div class="progress-bar-container">
    

    
</div>


<main class="page-container">

    

    <div class="page-main-content">

        <div class="page-main-content-top">
            <header class="header-wrapper">

    <div class="header-content">
        <div class="left">
            
            <a class="logo-title" href="/">
                cfanr&#39;s Blog
            </a>
        </div>

        <div class="right">
            <div class="pc">
                <ul class="menu-list">
                    
                        <li class="menu-item">
                            <a class="active"
                               href="/"
                            >
                                HOME
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/archives"
                            >
                                ARCHIVES
                            </a>
                        </li>
                    
                    
                </ul>
            </div>
            <div class="mobile">
                
                <div class="icon-item menu-bar">
                    <div class="menu-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="header-drawer">
        <ul class="drawer-menu-list">
            
                <li class="drawer-menu-item flex-center">
                    <a class="active"
                       href="/">HOME</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/archives">ARCHIVES</a>
                </li>
            
        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="page-main-content-middle">

            <div class="main-content">

                
                    <div class="home-content-container fade-in-down-animation">
    <ul class="home-article-list">
        
            <li class="home-article-item">

                

                <h3 class="home-article-title">
                    <a href="/2017/01/24/solve-Android-video-guide-page-black-screen/">
                        ANDROID视频引导滑动黑屏扫雷以及解决方案
                    </a>
                </h3>

                <div class="home-article-content markdown-body">
                    
                        <p>前一段时间，公司项目需要做一个视频引导的功能，刚开始以为用个 ViewPager+Fragment+VideoView 不就实现了吗，很快就弄好了。不过后来测试发现在滑动切换页面时会出现黑屏，比较影响用户体验，然后在网上找了各种“可行”的方案，都未能完全解决，最后尝试了一种巧妙的方法才解决这个问题。</p>
<p>首先说明下，这里视频引导用到的技术点是 ViewPager+Fragment+VideoView（当然也使用过 SurfaceView 来实现，不过原理基本一致），产品提供四个单独的视频（不是一个视频）+ 引导的圆点和进入主页的按钮（不是直接添加在视频上的）。另外限制条件是，产品未提供每个视频的第一帧的图片。</p>
                    
                </div>

                <div class="home-article-meta-info-container">
    <div class="home-article-meta-info">
        <span><i class="fas fa-history"></i>&nbsp;<span class="home-article-date" data-date="Tue Jan 24 2017 10:51:29 GMT+0800">2017-01-24</span></span>
        
        
    </div>

    <a href="/2017/01/24/solve-Android-video-guide-page-black-screen/">Read more&nbsp;<i class="fas fa-angle-right"></i></a>
</div>

            </li>
        
            <li class="home-article-item">

                

                <h3 class="home-article-title">
                    <a href="/2016/12/07/use-Builder-pattern-realize-a-new-function-guide-page-manager/">
                        Android用建造者模式实现一个新功能引导页
                    </a>
                </h3>

                <div class="home-article-content markdown-body">
                    
                        <p>最近每次版本更新都会在UI变动或加了新功能的地方加一个引导蒙层页面（新功能标记、文案和一个“知道了”的按钮），有时候一个版本会加三四个页面，原来的做法是：</p>
<ul>
<li>1.在每个Activity的布局文件外层添加一个FrameLayout(这方法好蠢，又要嵌套一层布局)；</li>
<li>2.再将需要显示的引导页布局加在后面(或用include的方式);</li>
<li>3.写两个方法，获取和设置是否显示了该引导页的判断，存储到SharedPreferences;</li>
<li>4.最后在对应Activity页面添加对应控制引导页显隐的逻辑</li>
</ul>
<p>每添加一个页面就要重复上面四个步骤，而且之后版本迭代需要去掉这些冗余代码时也比较麻烦，改动的地方比较多，不利于管理。<br>这方法太笨了，不能纯粹只为了完成功能呀，于是想了一个简单有效的方法。</p>
                    
                </div>

                <div class="home-article-meta-info-container">
    <div class="home-article-meta-info">
        <span><i class="fas fa-history"></i>&nbsp;<span class="home-article-date" data-date="Wed Dec 07 2016 15:46:57 GMT+0800">2016-12-07</span></span>
        
        
    </div>

    <a href="/2016/12/07/use-Builder-pattern-realize-a-new-function-guide-page-manager/">Read more&nbsp;<i class="fas fa-angle-right"></i></a>
</div>

            </li>
        
            <li class="home-article-item">

                

                <h3 class="home-article-title">
                    <a href="/2016/08/10/Android-Handler-AsyncTask-Thread-and-Service/">
                        Android中的Handler, AsyncTask, Thread和Service相关
                    </a>
                </h3>

                <div class="home-article-content markdown-body">
                    
                        <h3 id="Android中Handler和AsyncTask的区别"><a href="#Android中Handler和AsyncTask的区别" class="headerlink" title="Android中Handler和AsyncTask的区别"></a>Android中Handler和AsyncTask的区别</h3><p><img src="http://7xigjz.com1.z0.glb.clouddn.com/Handler%E5%92%8CAsyncTask%E5%8C%BA%E5%88%AB.png"></p>
<p>注：AsyncTask在1.6前是串行的，在1.6开始采用并行，不过到3.0又改回串行，避免并行带来的错误(在1.6-3.0以前，系统默认最大并发执行5个线程，缓冲线程队列最大128个，10个任务的等待，超过会出现java.util.concurrent.RejectedExecutionException异常。在3.0以后，无论有多少任务，都会在其内部单线程执行；)<br>3.1系统以上，可以调用new AsyncTask().executeOnExecutor(Executor exec, Params… params)自定义线程池执行</p>
<p>附：</p>
<ul>
<li><a class="link"   target="_blank" rel="noopener" href="http://www.jianshu.com/p/78e125e1e838" >****<i class="fas fa-external-link-alt"></i></a></li>
<li><a class="link"   target="_blank" rel="noopener" href="http://blog.csdn.net/iispring/article/details/47180325" >深入源码解析Android中的Handler,Message,MessageQueue,Looper<i class="fas fa-external-link-alt"></i></a></li>
<li><a class="link"   target="_blank" rel="noopener" href="http://blog.csdn.net/u012403246/article/details/45949963" > Android消息处理机制：源码剖析Handler、Looper，并实现图片异步加载<i class="fas fa-external-link-alt"></i></a></li>
<li><a class="link"   target="_blank" rel="noopener" href="http://www.cnblogs.com/whoislcj/p/5610903.html" >Android线程管理相关系列<i class="fas fa-external-link-alt"></i></a></li>
</ul>
                    
                </div>

                <div class="home-article-meta-info-container">
    <div class="home-article-meta-info">
        <span><i class="fas fa-history"></i>&nbsp;<span class="home-article-date" data-date="Wed Aug 10 2016 18:03:17 GMT+0800">2016-08-10</span></span>
        
        
    </div>

    <a href="/2016/08/10/Android-Handler-AsyncTask-Thread-and-Service/">Read more&nbsp;<i class="fas fa-angle-right"></i></a>
</div>

            </li>
        
            <li class="home-article-item">

                

                <h3 class="home-article-title">
                    <a href="/2016/07/20/Android-code-style/">
                        Android编程规范
                    </a>
                </h3>

                <div class="home-article-content markdown-body">
                    
                        <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>在软件开发中，没有规矩不成方圆，但规则是人制定的，没有标准，只有适合自己或团队的才是最好的，当然前提是整体上要符合编程语言的规范。</p>
<h2 id="一、命名规范"><a href="#一、命名规范" class="headerlink" title="一、命名规范"></a>一、命名规范</h2><h3 id="1-包命名"><a href="#1-包命名" class="headerlink" title="1.包命名"></a>1.包命名</h3><p>规则：包名全部小写，采用反域名命名规则，一级包名是顶级域名，通常为com, edu, gov, net, org等，二级包名，通常为公司名或部门名或者个人名，三级包名通常为项目名，四级包名为模块名或者层级名。以下是从层级包名来划分Android项目中采用的包划分结构：(在实际项目中可以采用包命名和模块命名结合的方式)</p>
                    
                </div>

                <div class="home-article-meta-info-container">
    <div class="home-article-meta-info">
        <span><i class="fas fa-history"></i>&nbsp;<span class="home-article-date" data-date="Wed Jul 20 2016 14:37:05 GMT+0800">2016-07-20</span></span>
        
        
    </div>

    <a href="/2016/07/20/Android-code-style/">Read more&nbsp;<i class="fas fa-angle-right"></i></a>
</div>

            </li>
        
            <li class="home-article-item">

                

                <h3 class="home-article-title">
                    <a href="/2016/07/15/art-of-android-development-chapter-4/">
                        Android 开发艺术探索笔记-4.View的工作原理
                    </a>
                </h3>

                <div class="home-article-content markdown-body">
                    
                        <h3 id="4-1初识ViewRoot和DecorView"><a href="#4-1初识ViewRoot和DecorView" class="headerlink" title="4.1初识ViewRoot和DecorView"></a>4.1初识ViewRoot和DecorView</h3><p><code>ViewRoot</code>对应于<code>ViewRootImpl</code>类，它是连接<code>WindowManager</code>和<code>DecorView</code>的纽带，View的三大流程都是通过<code>ViewRoot</code>来完成的。<br>在ActivityThread中，当Activity对象被创建完毕后，会将DecorView添加到Window中，同时会创建ViewRootImpl对象，并将ViewRootImpl对象和DecorView建立关联，源码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root = <span class="keyword">new</span> <span class="title class_">ViewRootImpl</span>(view.getContext(), display);</span><br><span class="line">root.setView(view, wparam, panelParentView);</span><br></pre></td></tr></table></figure>
<p>View的绘制流程是从ViewRoot的performTraversals方法开始的，它经过measure、layout和draw三个过程才能最终将一个View绘制出来，其中measure用来测量View的宽和高，layout用来确定View在父容器中的放置位置，而draw则负责将View绘制在屏幕上，流程如图：</p>
                    
                </div>

                <div class="home-article-meta-info-container">
    <div class="home-article-meta-info">
        <span><i class="fas fa-history"></i>&nbsp;<span class="home-article-date" data-date="Fri Jul 15 2016 22:53:16 GMT+0800">2016-07-15</span></span>
        
        
    </div>

    <a href="/2016/07/15/art-of-android-development-chapter-4/">Read more&nbsp;<i class="fas fa-angle-right"></i></a>
</div>

            </li>
        
            <li class="home-article-item">

                

                <h3 class="home-article-title">
                    <a href="/2016/07/13/art-of-android-development-chapter-3/">
                        Android 开发艺术探索笔记-3.View的事件体系
                    </a>
                </h3>

                <div class="home-article-content markdown-body">
                    
                        <h3 id="3-1-View基础知识"><a href="#3-1-View基础知识" class="headerlink" title="3.1 View基础知识"></a>3.1 View基础知识</h3><p>1.View是所以控件的基类，ViewGroup也属于View</p>
<p>2.View的位置参数<br>由top、left、right、bottom，左上角和右下角的横纵坐标决定（相对View的父容器）。<br>Android3.0开始增加了几个参数：左上角坐标x和y、左上角相对父容器的偏移量translationX和translationY（默认值为0）<br>x &#x3D; left + translationX<br>y &#x3D; top + translationY<br>平移时，top、left不会发生改变，始终为原始坐标</p>
                    
                </div>

                <div class="home-article-meta-info-container">
    <div class="home-article-meta-info">
        <span><i class="fas fa-history"></i>&nbsp;<span class="home-article-date" data-date="Wed Jul 13 2016 23:53:12 GMT+0800">2016-07-13</span></span>
        
        
    </div>

    <a href="/2016/07/13/art-of-android-development-chapter-3/">Read more&nbsp;<i class="fas fa-angle-right"></i></a>
</div>

            </li>
        
            <li class="home-article-item">

                

                <h3 class="home-article-title">
                    <a href="/2016/07/10/art-of-android-development-chapter-2/">
                        Android开发艺术探索笔记-2.IPC机制
                    </a>
                </h3>

                <div class="home-article-content markdown-body">
                    
                        <h3 id="2-1-Android-IPC简介"><a href="#2-1-Android-IPC简介" class="headerlink" title="2.1 Android IPC简介"></a>2.1 Android IPC简介</h3><p>IPC是Inter-Process Communication的缩写，是进程间的通信或跨进程通信，指两个进程之间进行数据交换的过程。线程是CPU调度的最小单位，是一种有限的系统资源，而进程一般指一个执行单元，可以包含多个线程。任何一个系统都有IPC机制，Linux上是通过命令管道、共享内容、信号量来进行进程间通信的。</p>
<h3 id="2-2-Android中的多进程模式"><a href="#2-2-Android中的多进程模式" class="headerlink" title="2.2 Android中的多进程模式"></a>2.2 Android中的多进程模式</h3><p>(1). 开启多进程模式<br>为四大组件在AndroidManifest中指定android:process属性：</p>
<ul>
<li>指定完整进程名，如android:process&#x3D;”com.google.play.remote”。</li>
<li>以“:”开头，比如设置为android:process&#x3D;”:remote”。则系统会在实际运行的进程名前加上应用程序的包名，即变成“com.google.play:remote”</li>
</ul>
                    
                </div>

                <div class="home-article-meta-info-container">
    <div class="home-article-meta-info">
        <span><i class="fas fa-history"></i>&nbsp;<span class="home-article-date" data-date="Sun Jul 10 2016 23:42:17 GMT+0800">2016-07-10</span></span>
        
        
    </div>

    <a href="/2016/07/10/art-of-android-development-chapter-2/">Read more&nbsp;<i class="fas fa-angle-right"></i></a>
</div>

            </li>
        
            <li class="home-article-item">

                

                <h3 class="home-article-title">
                    <a href="/2016/07/07/art-of-android-development-chapter-1/">
                        Android开发艺术探索笔记-1.Activity的生命周期和启动模式
                    </a>
                </h3>

                <div class="home-article-content markdown-body">
                    
                        <h3 id="1-1Activity生命周期全面分析"><a href="#1-1Activity生命周期全面分析" class="headerlink" title="1.1Activity生命周期全面分析"></a>1.1Activity生命周期全面分析</h3><p><img src="http://7xigjz.com1.z0.glb.clouddn.com/activity-lifecycle.png" alt="activity lifecycle"></p>
<ul>
<li>onCreate(), 加载界面布局资源，初始化Activity需要的数据等</li>
<li>onStart(), Activity已经是可见状态，但未出现在前台，无法与用户交互；</li>
<li>onResume(), Activity已经可见，处于前台，所以一般如果需要返回页面自动刷新数据时，将请求的方法放在onResume;</li>
<li>onPause(), 不能做太耗时的操作，<strong>onPause必须执行完，新的Activity才会启动</strong>，也就是说ActivityA跳转到ActivityB，执行顺序: ……A:onPause()-&gt;B:onCreate()-&gt;B:onStart()-&gt;B:onResume()-&gt;A:onStop()</li>
<li>onStop(), Activity不可见时会调用，所以<strong>当新的Activity采用透明主题时，当前Activity不会调用onStop()</strong>;</li>
<li>onDestroy(), 回收资源，取消注册广播等；</li>
</ul>
<p>onStart()和onStop()是从Activity<strong>是否可见</strong>来回调，而onResume()和onPause()是从Activity<strong>是否位于前台</strong>来回调。</p>
                    
                </div>

                <div class="home-article-meta-info-container">
    <div class="home-article-meta-info">
        <span><i class="fas fa-history"></i>&nbsp;<span class="home-article-date" data-date="Thu Jul 07 2016 21:32:10 GMT+0800">2016-07-07</span></span>
        
        
    </div>

    <a href="/2016/07/07/art-of-android-development-chapter-1/">Read more&nbsp;<i class="fas fa-angle-right"></i></a>
</div>

            </li>
        
            <li class="home-article-item">

                

                <h3 class="home-article-title">
                    <a href="/2016/06/26/clear-redundancy-Java-code-toolol%E2%80%94Lombok/">
                        Android中消除Java冗长代码神器——Lombok
                    </a>
                </h3>

                <div class="home-article-content markdown-body">
                    
                        <h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p>Android中经常需要建一些数据的实体类，然后实现它们的getter和setter的方法，虽然有JsonFormat的插件可以一键生成对应的getter和setter的方法，但是如果一个实体类有几十个变量的话，生成大量的代码，使这个实体类不够简洁。而Lombok正是一个可以消除Java冗长代码，使代码更精简和优雅的注解工具。它可以在编译期自动生成getter&#x2F;setter&#x2F;toString&#x2F;equals&#x2F;hashCode&#x2F;constructor等方法，而在实体类中隐藏掉(不写)这些方法(代码中还可以引用)，从而减少代码量，使代码更精简。</p>
                    
                </div>

                <div class="home-article-meta-info-container">
    <div class="home-article-meta-info">
        <span><i class="fas fa-history"></i>&nbsp;<span class="home-article-date" data-date="Sun Jun 26 2016 17:16:11 GMT+0800">2016-06-26</span></span>
        
        
    </div>

    <a href="/2016/06/26/clear-redundancy-Java-code-toolol%E2%80%94Lombok/">Read more&nbsp;<i class="fas fa-angle-right"></i></a>
</div>

            </li>
        
            <li class="home-article-item">

                

                <h3 class="home-article-title">
                    <a href="/2016/04/25/Android-realize-multi-type-item-s-layout-by-ListView/">
                        Android利用ListView实现多种Item的复杂布局
                    </a>
                </h3>

                <div class="home-article-content markdown-body">
                    
                        <p>在Android开发中，可能会遇到一个可滚动且布局比较复杂的界面，但它并不是一个纯粹的List，类似如下图:</p>
<p><img src="http://7xigjz.com1.z0.glb.clouddn.com/160425-demo.bmp" alt="demo.png"><br>通常实现方法可以直接用一个ScrollView将所有内容包起来，里面是列表的部分在代码中用动态添加布局的方式实现；或者外层ScrollView，里面列表部分用ListView(或RecyclerView)实现，但这样需要解决滑动冲突问题(有时并不能很好解决)……所以最好不要同时使用ScrollView和ListView(或RecyclerView)，但如果单使用ScrollView，每次滑动返回时都会重新动态加载，如果页面图片比较多，可能会造成卡顿，所以要自己做缓存判断的处理，而ListView自带有缓存机制，处理相对比较方便。</p>
                    
                </div>

                <div class="home-article-meta-info-container">
    <div class="home-article-meta-info">
        <span><i class="fas fa-history"></i>&nbsp;<span class="home-article-date" data-date="Mon Apr 25 2016 11:25:27 GMT+0800">2016-04-25</span></span>
        
        
    </div>

    <a href="/2016/04/25/Android-realize-multi-type-item-s-layout-by-ListView/">Read more&nbsp;<i class="fas fa-angle-right"></i></a>
</div>

            </li>
        
    </ul>

    <div class="home-paginator">
        <div class="paginator">
    
        <a class="prev btn"
           href="/"
        >Prev</a>
    

    
        <a class="next btn"
           href="/page/3/"
        >Next</a>
    
</div>

    </div>
</div>


                
            </div>

        </div>

        <div class="page-main-content-bottom">
            <footer class="footer">
    <div class="info-container">
        <div class="copyright-info info-item">
            &copy;
            
              <span>2020</span>
              -
            
            2022&nbsp;<i class="fas fa-heart icon-animate"></i>&nbsp;<a href="/">cfanr</a>
        </div>
        
        <div class="theme-info info-item">
            Powered by <a target="_blank" href="https://hexo.io">Hexo</a>&nbsp;|&nbsp;Theme&nbsp;<a class="theme-version" target="_blank" href="https://github.com/XPoet/hexo-theme-keep">Keep v3.4.5</a>
        </div>
        
        
    </div>
</footer>

        </div>
    </div>

    

    <div class="right-bottom-side-tools">
        <div class="side-tools-container">
    <ul class="side-tools-list">
        <li class="tools-item tool-font-adjust-plus flex-center">
            <i class="fas fa-search-plus"></i>
        </li>

        <li class="tools-item tool-font-adjust-minus flex-center">
            <i class="fas fa-search-minus"></i>
        </li>

        <li class="tools-item tool-expand-width flex-center">
            <i class="fas fa-arrows-alt-h"></i>
        </li>

        <li class="tools-item tool-dark-light-toggle flex-center">
            <i class="fas fa-moon"></i>
        </li>

        <!-- rss -->
        

        
            <li class="tools-item tool-scroll-to-top flex-center">
                <i class="fas fa-arrow-up"></i>
            </li>
        

        <li class="tools-item tool-scroll-to-bottom flex-center">
            <i class="fas fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="exposed-tools-list">
        <li class="tools-item tool-toggle-show flex-center">
            <i class="fas fa-cog fa-spin"></i>
        </li>
        
    </ul>
</div>

    </div>

    

    <div class="image-viewer-container">
    <img src="">
</div>


    

</main>





<script src="/js/utils.js"></script>

<script src="/js/main.js"></script>

<script src="/js/header-shrink.js"></script>

<script src="/js/back2top.js"></script>

<script src="/js/dark-light-toggle.js"></script>








<div class="post-scripts">
    
</div>



</body>
</html>
